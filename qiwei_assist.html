<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼ä¸šå¾®ä¿¡ AI åŠ©ç† - äº¤äº’å¼æŒ‡å—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Developer's Calm -->
    <!-- Application Structure Plan: The SPA is designed as an interactive dashboard, diverging from the linear report format. A sticky top navigation allows users to jump to key thematic sections: 1. **æ¦‚è§ˆ (Overview)**: High-level introduction. 2. **æ ¸å¿ƒæµç¨‹ (Core Flow)**: An interactive, clickable diagram of the 11-step system architecture, which is the centerpiece of the application. Users can click each step to get detailed information. 3. **æŠ€æœ¯æ ˆ (Tech Stack)**: A card-based layout presenting the key technologies with expandable details. 4. **å®ç°ç»†èŠ‚ (Implementation)**: A tabbed interface to view key Go code snippets without overwhelming the user. 5. **éƒ¨ç½²æŒ‡å— (Deployment)**: A clear, actionable checklist for configuration and deployment. This non-linear, task-oriented structure enhances usability by allowing developers to quickly find and digest the information most relevant to them, rather than scrolling through a long document. -->
    <!-- Visualization & Content Choices: 1. **System Flow Diagram (æ ¸å¿ƒæµç¨‹)**: Report Info: 11-step request/response cycle. Goal: Organize/Explain. Method: Interactive diagram built with HTML/CSS (divs, flexbox, borders) instead of a static list. Interaction: Clicking a step highlights it and displays its description. Justification: Visually engaging and clarifies complex data flow, which is the core of the report. Library: Vanilla JS + Tailwind. 2. **Directory Structure (éƒ¨ç½²æŒ‡å—)**: Report Info: Text-based tree. Goal: Organize. Method: Collapsible tree view using nested HTML lists. Interaction: Clicking folders expands/collapses them. Justification: More interactive and space-efficient than a static text block. Library: Vanilla JS. 3. **Code Snippets (å®ç°ç»†èŠ‚)**: Report Info: Multiple Go code blocks. Goal: Inform. Method: Tabbed component. Interaction: Clicking tabs switches between different code files. Justification: Organizes large amounts of code cleanly, preventing a long scroll. Library: Vanilla JS. 4. **Configuration Table (éƒ¨ç½²æŒ‡å—)**: Report Info: Markdown table of ENV vars. Goal: Inform. Method: HTML table with enhanced styling. Interaction: Hover effects and copy-to-clipboard buttons. Justification: Improves usability for developers. Library: Vanilla JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8f9fa;
            color: #212529;
        }
        .nav-link {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active, .nav-link:hover {
            color: #087ea4;
            border-bottom-color: #087ea4;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .flow-step {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .flow-step.active, .flow-step:hover {
            border-color: #087ea4;
            background-color: #eaf6fa;
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .flow-arrow {
            color: #a0aec0;
        }
        .tab-btn {
            transition: all 0.3s ease;
        }
        .tab-btn.active {
            background-color: #087ea4;
            color: white;
        }
        .code-block {
            background-color: #1e293b;
            color: #f8fafc;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            max-height: 500px;
        }
        .copy-btn {
            transition: all 0.2s ease;
        }
        .copy-btn:hover {
            background-color: #e2e8f0;
        }
        .copy-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-xl md:text-2xl font-bold text-gray-800">ä¼ä¸šå¾®ä¿¡ AI åŠ©ç†æ„å»ºæŒ‡å—</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">æ¦‚è§ˆ</a>
                        <a href="#flow" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">æ ¸å¿ƒæµç¨‹</a>
                        <a href="#tech" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">æŠ€æœ¯æ ˆ</a>
                        <a href="#implementation" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">å®ç°ç»†èŠ‚</a>
                        <a href="#deployment" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">éƒ¨ç½²æŒ‡å—</a>
                        <a href="#outlook" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-600">æœªæ¥å±•æœ›</a>
                    </div>
                </div>
                <div class="md:hidden">
                     <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-[#087ea4]">
                        <span class="sr-only">Open main menu</span>
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            <div id="mobile-menu" class="md:hidden hidden pb-3">
                <a href="#overview" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">æ¦‚è§ˆ</a>
                <a href="#flow" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">æ ¸å¿ƒæµç¨‹</a>
                <a href="#tech" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">æŠ€æœ¯æ ˆ</a>
                <a href="#implementation" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">å®ç°ç»†èŠ‚</a>
                <a href="#deployment" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">éƒ¨ç½²æŒ‡å—</a>
                <a href="#outlook" class="nav-link block px-3 py-2 rounded-md text-base font-medium text-gray-600">æœªæ¥å±•æœ›</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">

        <section id="overview" class="section">
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-4 text-gray-900">æ¶æ„è“å›¾ï¼šç”Ÿäº§çº§ AI åŠ©ç†</h2>
                <p class="text-gray-600 leading-relaxed mb-6">
                    æœ¬æŒ‡å—æ—¨åœ¨æ„å»ºä¸€ä¸ªä¸ä¼ä¸šå¾®ä¿¡æ·±åº¦é›†æˆçš„ç”Ÿäº§çº§ AI åŠ©ç†ã€‚ç³»ç»Ÿèƒ½å¤Ÿå®‰å…¨åœ°æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ï¼Œé€šè¿‡ä¸€ä¸ªä½¿ç”¨ <code class="bg-gray-200 text-sm font-mono p-1 rounded">cloudwego/eino</code> æ¡†æ¶æ„å»ºçš„æ™ºèƒ½ä»£ç†ï¼ˆAgentï¼‰è¿›è¡Œç†è§£å’Œæ¨ç†ï¼Œå¹¶è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼ˆMCP æœåŠ¡ï¼‰æ¥è·å–ä¿¡æ¯æˆ–æ‰§è¡Œæ“ä½œï¼Œæœ€ç»ˆç”Ÿæˆç²¾å‡†çš„å›å¤ã€‚
                </p>
                <div class="p-6 border border-blue-200 bg-blue-50 rounded-lg">
                    <h3 class="text-xl font-semibold text-blue-800 mb-3">æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šå…³æ³¨ç‚¹åˆ†ç¦»</h3>
                    <p class="text-blue-700">
                        æˆ‘ä»¬çš„æ¶æ„æ ¸å¿ƒæ˜¯å°† Web æœåŠ¡ä¸ AI é€»è¾‘å½»åº•è§£è€¦ã€‚**Gin Web æœåŠ¡å™¨**ä¸“æ³¨äºå¤„ç†ç½‘ç»œè¯·æ±‚ã€å®‰å…¨éªŒè¯å’Œæ•°æ®æ ¼å¼è½¬æ¢ï¼Œè€Œ **Eino AI Agent** åˆ™ä¸“æ³¨äºæ ¸å¿ƒçš„æ™ºèƒ½æ¨ç†ä¸å·¥å…·è°ƒç”¨ã€‚è¿™ç§åˆ†ç¦»ä½¿å¾—ç³»ç»Ÿå„éƒ¨åˆ†éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•ã€ç»´æŠ¤å’Œå‡çº§ï¼Œæ˜¯æ„å»ºå¯æ‰©å±•ã€é«˜é²æ£’æ€§å¤æ‚ç³»ç»Ÿçš„å…³é”®ã€‚
                    </p>
                </div>
            </div>
        </section>

        <section id="flow" class="section">
             <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-2 text-gray-900">æ ¸å¿ƒæµç¨‹ï¼šç«¯åˆ°ç«¯äº¤äº’è§£æ</h2>
                <p class="text-gray-600 mb-8 text-center">ç‚¹å‡»ä¸‹æ–¹æµç¨‹å›¾ä¸­çš„æ¯ä¸€æ­¥ï¼ŒæŸ¥çœ‹è¯¥ç¯èŠ‚çš„è¯¦ç»†è¯´æ˜ã€‚</p>
                
                <div class="flex flex-col lg:flex-row">
                    <div class="w-full lg:w-2/3">
                        <div id="flow-diagram" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-center">
                        </div>
                    </div>
                    <div class="w-full lg:w-1/3 mt-8 lg:mt-0 lg:pl-8">
                        <div id="flow-details" class="bg-gray-50 p-6 rounded-lg border sticky top-24 min-h-[300px]">
                            <h3 class="text-xl font-bold mb-4 text-gray-800" id="flow-detail-title">è¯·é€‰æ‹©ä¸€ä¸ªæµç¨‹èŠ‚ç‚¹</h3>
                            <p class="text-gray-600" id="flow-detail-content">è¯¦ç»†ä¿¡æ¯å°†åœ¨æ­¤å¤„æ˜¾ç¤ºã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="tech" class="section">
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-6 text-gray-900">æ ¸å¿ƒæŠ€æœ¯æ ˆ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="border rounded-lg p-6 hover:shadow-xl transition-shadow">
                        <h3 class="text-2xl font-bold mb-3">Gin æ¡†æ¶</h3>
                        <p class="text-gray-600 mb-4">ä½œä¸º HTTP ç½‘å…³ï¼ŒGin ä»¥å…¶å“è¶Šæ€§èƒ½å’Œæç®€ API è®¾è®¡è€Œé—»åã€‚å®ƒçš„ä¸­é—´ä»¶æœºåˆ¶éå¸¸é€‚åˆå¤„ç†ä¼ä¸šå¾®ä¿¡å›è°ƒçš„æ—¥å¿—ã€é‰´æƒå’Œè§£å¯†æµç¨‹ï¼Œä½¿ä»£ç ç»“æ„æ¸…æ™°ã€‚
                        </p>
                    </div>
                    <div class="border rounded-lg p-6 hover:shadow-xl transition-shadow">
                        <h3 class="text-2xl font-bold mb-3">Eino æ¡†æ¶</h3>
                        <p class="text-gray-600 mb-4">ä¸“ä¸º Golang æ‰“é€ çš„ LLM åº”ç”¨å¼€å‘æ¡†æ¶ã€‚å®ƒå¼ºè°ƒå¼ºç±»å‹å®‰å…¨å’Œæ€§èƒ½ï¼Œé€šè¿‡æ¸…æ™°çš„ç»„ä»¶åŒ–å’Œç¼–æ’èƒ½åŠ›ï¼Œæå¤§åœ°æé«˜äº†ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œæ˜¯æ„å»ºç”Ÿäº§çº§ AI Agent çš„å¯é é€‰æ‹©ã€‚</p>
                    </div>
                    <div class="border rounded-lg p-6 hover:shadow-xl transition-shadow">
                        <h3 class="text-2xl font-bold mb-3">ä¼ä¸šå¾®ä¿¡ SDK</h3>
                        <p class="text-gray-600 mb-4">ä¸ºäº†å®‰å…¨åœ°å¤„ç†ä¼ä¸šå¾®ä¿¡çš„åŠ å¯†å›è°ƒï¼Œæˆ‘ä»¬ç›´æ¥é‡‡ç”¨å®˜æ–¹ç¤ºä¾‹ä¸­çš„ <code class="bg-gray-200 text-sm font-mono p-1 rounded">wxbizmsgcrypt</code> åŠ å¯†åŒ…ï¼Œç¡®ä¿äº†å®‰å…¨æ€§ä¸åˆè§„æ€§ã€‚</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="implementation" class="section">
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-6 text-gray-900">å®ç°ç»†èŠ‚ï¼šæ ¸å¿ƒä»£ç ä¸€è§ˆ</h2>
                <div id="code-tabs-container">
                    <div class="border-b border-gray-200">
                        <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                        </nav>
                    </div>
                    <div id="code-content-container" class="mt-6">
                    </div>
                </div>
            </div>
        </section>

        <section id="deployment" class="section">
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-6 text-gray-900">éƒ¨ç½²æŒ‡å—</h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-semibold mb-4">ç¯å¢ƒå˜é‡é…ç½®</h3>
                        <p class="text-gray-600 mb-4">åº”ç”¨éµå¾ªåäºŒå› å­åŸåˆ™ï¼Œæ‰€æœ‰é…ç½®å‡é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ã€‚è¯·åœ¨éƒ¨ç½²ç¯å¢ƒä¸­è®¾ç½®ä»¥ä¸‹å˜é‡ï¼š</p>
                        <div class="overflow-x-auto rounded-lg border">
                            <table class="min-w-full bg-white">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ç¯å¢ƒå˜é‡</th>
                                        <th class="py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æè¿°</th>
                                        <th class="py-3 px-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="env-vars-table" class="divide-y divide-gray-200">
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-xl font-semibold mb-4">å®¹å™¨åŒ–éƒ¨ç½² (Dockerfile)</h3>
                        <p class="text-gray-600 mb-4">æˆ‘ä»¬ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºæ¥åˆ›å»ºæœ€å°ã€æœ€å®‰å…¨çš„ç”Ÿäº§é•œåƒï¼Œæå¤§åœ°å‡å°äº†é•œåƒä½“ç§¯å¹¶æå‡äº†å®‰å…¨æ€§ã€‚</p>
                        <div class="code-block">
<pre><code># --- Stage 1: Builder ---
FROM golang:1.22-alpine AS builder
WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 GOOS=linux go build \
    -ldflags="-s -w" -o /wecom-bot ./cmd/server

# --- Stage 2: Final Image ---
FROM scratch
COPY --from=builder /wecom-bot /wecom-bot
EXPOSE 8080
CMD ["/wecom-bot"]
</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="outlook" class="section">
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-3xl font-bold mb-6 text-gray-900">é«˜çº§åŠŸèƒ½ä¸æœªæ¥å±•æœ›</h2>
                <p class="text-gray-600 mb-8">
                    æˆ‘ä»¬å·²æˆåŠŸæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡ã€æ¶æ„å¥å£®çš„ AI åŠ©ç†ã€‚åŸºäºè¿™ä¸ªå¯æ‰©å±•çš„æ¶æ„ï¼Œæ‚¨å¯ä»¥ä¸æ–­åœ°ä¸ºå®ƒèµ‹äºˆæ–°çš„èƒ½åŠ›ï¼Œä½¿å…¶æˆä¸ºä¼ä¸šå†…éƒ¨ä¸å¯æˆ–ç¼ºçš„æ™ºèƒ½ä¸­æ¢ã€‚
                </p>
                <div class="space-y-6">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-[#087ea4] text-white flex items-center justify-center text-xl font-bold">Â»</div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold">å®ç°æµå¼å“åº”</h3>
                            <p class="text-gray-600">æ”¹é€  Gin å¤„ç†å™¨ä»¥æ”¯æŒæµå¼è¾“å‡ºï¼Œå¯ä»¥æå¤§æå‡ç”¨æˆ·ä½“éªŒï¼Œè®©å¯¹è¯æ„Ÿè§‰æ›´å®æ—¶ã€æ›´è‡ªç„¶ã€‚</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-[#087ea4] text-white flex items-center justify-center text-xl font-bold">ğŸ§ </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold">å¼•å…¥å¯¹è¯è®°å¿†</h3>
                            <p class="text-gray-600">é›†æˆ Eino æä¾›çš„è®°å¿†ç»„ä»¶ï¼Œä¸º Agent æ·»åŠ çŸ­æœŸæˆ–é•¿æœŸè®°å¿†ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†ä¸Šä¸‹æ–‡ç›¸å…³çš„è¿ç»­å¯¹è¯ã€‚</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <div class="flex-shrink-0 h-10 w-10 rounded-full bg-[#087ea4] text-white flex items-center justify-center text-xl font-bold">ğŸ› ï¸</div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold">æ‰©å±•å·¥å…·é›†</h3>
                            <p class="text-gray-600">å°è£…æ›´å¤š "MCP æœåŠ¡" ä½œä¸ºå·¥å…·ï¼Œå¦‚æŸ¥è¯¢å†…éƒ¨çŸ¥è¯†åº“ã€è¿æ¥ CRM ç³»ç»Ÿã€åˆ›å»ºæ—¥å†äº‹ä»¶ç­‰ï¼Œä¸æ–­å¢å¼º Agent çš„èƒ½åŠ›è¾¹ç•Œã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            const flowData = [
                { title: '1. ç”¨æˆ·å‘èµ·è¯·æ±‚', content: 'ä¼ä¸šå¾®ä¿¡ç”¨æˆ·åœ¨è‡ªå»ºåº”ç”¨ä¸­å‘é€ä¸€æ¡æ¶ˆæ¯ã€‚' },
                { title: '2. ä¼ä¸šå¾®ä¿¡ç½‘å…³', content: 'ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨æ¥æ”¶æ¶ˆæ¯ï¼Œå¹¶å‘æˆ‘ä»¬é…ç½®çš„å›è°ƒ URL å‘èµ·åŠ å¯†çš„ HTTP POST è¯·æ±‚ã€‚' },
                { title: '3. Go/Gin å›è°ƒæœåŠ¡å™¨', content: 'ä½œä¸ºç³»ç»Ÿå…¥å£çš„å…¬ç½‘ Go HTTP æœåŠ¡æ¥æ”¶è¯·æ±‚ã€‚é€‰ç”¨ Gin æ¡†æ¶ä»¥ä¿è¯é«˜æ€§èƒ½ã€‚' },
                { title: '4. è®¤è¯ä¸è§£å¯†', content: 'Gin ä¸­é—´ä»¶éªŒè¯è¯·æ±‚ç­¾åï¼Œå¹¶ä½¿ç”¨é¢„è®¾çš„ EncodingAESKey å¯¹æ¶ˆæ¯ä½“è¿›è¡Œè§£å¯†ã€‚' },
                { title: '5. æ¶ˆæ¯è§£æ', content: 'è§£å¯†åçš„ XML æ–‡æœ¬è¢«è§£æï¼ˆBindï¼‰åˆ°ä¸€ä¸ªé¢„å®šä¹‰çš„ Go ç»“æ„ä½“ä¸­ï¼Œè½¬ä¸ºç»“æ„åŒ–æ•°æ®ã€‚' },
                { title: '6. è°ƒç”¨ Eino Agent', content: 'Gin å¤„ç†å™¨å°†è§£æå‡ºçš„ç”¨æˆ·é—®é¢˜ä¼ é€’ç»™ç³»ç»Ÿçš„â€œå¤§è„‘â€â€”â€”Eino AI Agentã€‚' },
                { title: '7. Agent æ¨ç†ä¸å·¥å…·è°ƒç”¨', content: 'Eino Agent åˆ©ç”¨ LLM è¿›è¡Œæ¨ç†ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·æ¥å›ç­”é—®é¢˜ã€‚' },
                { title: '8. æ‰§è¡Œè‡ªå®šä¹‰å·¥å…·', content: 'Agent æ ¹æ® LLM çš„æŒ‡ä»¤ï¼Œæ‰§è¡Œé¢„å…ˆå®šä¹‰å¥½çš„â€œmcp æœåŠ¡â€ï¼ˆè¢«å°è£…ä¸º Eino Toolï¼‰ã€‚' },
                { title: '9. æ•´åˆä¿¡æ¯ç”Ÿæˆå›å¤', content: 'å·¥å…·æ‰§è¡Œç»“æœè¿”å›ç»™ Agentï¼ŒAgent å†æ¬¡æäº¤ç»™ LLM ä»¥ç”Ÿæˆæœ€ç»ˆçš„è‡ªç„¶è¯­è¨€å›å¤ã€‚' },
                { title: '10. åŠ å¯†å¹¶å“åº”', content: 'Gin å¤„ç†å™¨å°† Agent çš„å›å¤æ‰“åŒ…æˆ XML æ ¼å¼ï¼Œç„¶åè¿›è¡ŒåŠ å¯†å’Œç­¾åã€‚' },
                { title: '11. è¿”å›å“åº”', content: 'åŠ å¯†åçš„ XML å“åº”é€šè¿‡ HTTP 200 OK è¿”å›ç»™ä¼ä¸šå¾®ä¿¡æœåŠ¡å™¨ï¼Œæœ€ç»ˆå‘ˆç°ç»™ç”¨æˆ·ã€‚' }
            ];

            const codeData = {
                "main.go": `package main\n\nimport (\n\t"context"\n\t"fmt"\n\t"log/slog"\n\t"net/http"\n\t"os"\n\t"os/signal"\n\t"syscall"\n\t"time"\n\n\t"wecom-eino-bot/internal/agent"\n\t"wecom-eino-bot/internal/config"\n\t"wecom-eino-bot/internal/web"\n)\n\nfunc main() {\n\tlogger := slog.New(slog.NewJSONHandler(os.Stdout, nil))\n\tslog.SetDefault(logger)\n\n\tcfg, err := config.Load()\n\tif err != nil {\n\t\tslog.Error("æ— æ³•åŠ è½½é…ç½®", "error", err)\n\t\tos.Exit(1)\n\t}\n\n\taiAgent, err := agent.NewAIAgent(context.Background(), cfg)\n\tif err != nil {\n\t\tslog.Error("æ— æ³•åˆå§‹åŒ– AI Agent", "error", err)\n\t\tos.Exit(1)\n\t}\n\n\thandler := web.NewWeComHandler(cfg, aiAgent)\n\trouter := web.NewRouter(handler)\n\n\tsrv := &http.Server{\n\t\tAddr:    fmt.Sprintf(":%s", cfg.Port),\n\t\tHandler: router,\n\t}\n\n\tgo func() {\n\t\tslog.Info("æœåŠ¡å™¨å¯åŠ¨", "address", srv.Addr)\n\t\tif err := srv.ListenAndServe(); err != nil && err != http.ErrServerClosed {\n\t\t\tslog.Error("æœåŠ¡å™¨å¯åŠ¨å¤±è´¥", "error", err)\n\t\t\tos.Exit(1)\n\t\t}\n\t}()\n\n\tquit := make(chan os.Signal, 1)\n\tsignal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)\n\t<-quit\n\tslog.Info("æœåŠ¡å™¨æ­£åœ¨å…³é—­...")\n\n\tctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\n\tdefer cancel()\n\tif err := srv.Shutdown(ctx); err != nil {\n\t\tslog.Error("æœåŠ¡å™¨å…³é—­å¤±è´¥", "error", err)\n\t\tos.Exit(1)\n\t}\n\n\tslog.Info("æœåŠ¡å™¨å·²æˆåŠŸå…³é—­")\n}`,
                "handler.go": `package web\n\nimport (\n\t"encoding/xml"\n\t"io"\n\t"log/slog"\n\t"net/http"\n\t"strconv"\n\t"time"\n\n\t"github.com/cloudwego/eino/schema"\n\t"github.com/gin-gonic/gin"\n\t"wecom-eino-bot/internal/agent"\n\t"wecom-eino-bot/internal/config"\n\t"wecom-eino-bot/pkg/wecom"\n)\n\ntype WeComHandler struct {\n\tcfg   *config.Config\n\tagent *agent.AIAgent\n\tcrypt *wecom.Crypto\n}\n\nfunc (h *WeComHandler) handlePostMessage(c *gin.Context) {\n\tbody, err := io.ReadAll(c.Request.Body)\n\n\tmsg, cryptErr := h.crypt.DecryptMsg(msgSignature, timestamp, nonce, body)\n\n\tvar reqMsg wecom.ReceivedMessage\n\tif err := xml.Unmarshal(msg, &reqMsg); err != nil { /* ... */ }\n\n\tif reqMsg.MsgType != "text" { /* ... */ }\n\n\tuserInput := *schema.Message{schema.UserMessage(reqMsg.Content)}\n\tresponseMessage, err := h.agent.Generate(c.Request.Context(), userInput)\n\n\th.sendReply(c, reqMsg.FromUserName, reqMsg.ToUserName, responseMessage.Content)\n}`,
                "agent.go": `package agent\n\nimport (\n\t"context"\n\t"fmt"\n\t"github.com/cloudwego/eino/components/model"\n\t"github.com/cloudwego/eino/compose"\n\t"github.com/cloudwego/eino/flow/agent/react"\n\t"github.com/cloudwego/eino/schema"\n\t"github.com/cloudwego/eino-ext/components/model/openai"\n\t"wecom-eino-bot/internal/config"\n)\n\ntype AIAgent struct {\n\tagent *react.Agent\n}\n\nfunc NewAIAgent(ctx context.Context, cfg *config.Config) (*AIAgent, error) {\n\tchatModel, err := openai.NewChatModel(ctx, &openai.ChatModelConfig{\n\t\tAPIKey:  cfg.OpenAIAPIKey,\n\t\tModel:   "gpt-4o",\n\t})\n\n\ttools, err := initTools()\n\ttoolsConfig := &compose.ToolsNodeConfig{ Tools: tools }\n\n\tagent, err := react.NewAgent(ctx, &react.AgentConfig{\n\t\tToolCallingModel: chatModel,\n\t\tToolsConfig:      toolsConfig,\n\t\tMessageModifier: func(ctx context.Context, input *schema.Message) *schema.Message {\n\t\t\tsystemPrompt := "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„ä¼ä¸šå¾®ä¿¡ AI åŠ©ç†ã€‚"\n\t\t\treturn append(*schema.Message{schema.SystemMessage(systemPrompt)}, input...)\n\t\t},\n\t})\n\n\treturn &AIAgent{agent: agent}, nil\n}\n\nfunc (a *AIAgent) Generate(ctx context.Context, input *schema.Message, opts ...model.Option) (*schema.Message, error) {\n\treturn a.agent.Generate(ctx, input)\n}`,
                "tools.go": `package agent\n\nimport (\n\t"context"\n\t"fmt"\n\t"github.com/cloudwego/eino/components/tool"\n\t"github.com/cloudwego/eino/components/tool/utils"\n)\n\ntype WeatherRequest struct {\n\tCity string \`json:"city" jsonschema:"required,description=éœ€è¦æŸ¥è¯¢å¤©æ°”çš„åŸå¸‚åç§°,example=æ·±åœ³"\`\n}\n\ntype WeatherResponse struct {\n\tTemperature int    \`json:"temperature"\`\n\tCondition   string \`json:"condition"\`\n}\n\nfunc getWeather(ctx context.Context, req *WeatherRequest) (*WeatherResponse, error) {\n\t// æ¨¡æ‹Ÿ API è°ƒç”¨\n\tswitch req.City {\n\tcase "åŒ—äº¬":\n\t\treturn &WeatherResponse{Temperature: 15, Condition: "å¤šäº‘"}, nil\n\tcase "ä¸Šæµ·":\n\t\treturn &WeatherResponse{Temperature: 22, Condition: "å°é›¨"}, nil\n\tdefault:\n\t\treturn &WeatherResponse{Temperature: 20, Condition: "æœªçŸ¥"}, nil\n\t}\n}\n\nfunc newWeatherTool() (tool.InvokableTool, error) {\n\treturn utils.InferTool(\n\t\t"get_weather",\n\t\t"æ ¹æ®åŸå¸‚åç§°è·å–å½“å‰çš„å¤©æ°”ä¿¡æ¯",\n\t\tgetWeather,\n\t)\n}`
            };

            const envVars = [
                { name: 'PORT', desc: 'Web æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£' },
                { name: 'WECOM_CORP_ID', desc: 'ä¼ä¸š ID' },
                { name: 'WECOM_AGENT_ID', desc: 'è‡ªå»ºåº”ç”¨çš„ AgentId' },
                { name: 'WECOM_CALLBACK_TOKEN', desc: 'å›è°ƒéªŒè¯ Token' },
                { name: 'WECOM_CALLBACK_AES_KEY', desc: 'å›è°ƒæ¶ˆæ¯ä½“ AES å¯†é’¥' },
                { name: 'OPENAI_API_KEY', desc: 'å¤§è¯­è¨€æ¨¡å‹ API å¯†é’¥' },
            ];
            
            function showSection(hash) {
                sections.forEach(section => {
                    if ('#' + section.id === hash) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
                navLinks.forEach(link => {
                    if (link.getAttribute('href') === hash) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            function setupNavigation() {
                const hash = window.location.hash || '#overview';
                showSection(hash);
                
                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetHash = e.target.getAttribute('href');
                        history.pushState(null, null, targetHash);
                        showSection(targetHash);
                        if (mobileMenu.classList.contains('hidden') === false) {
                           mobileMenu.classList.add('hidden');
                        }
                    });
                });
                 window.addEventListener('popstate', () => {
                    showSection(window.location.hash || '#overview');
                });
            }
            
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            function setupFlowDiagram() {
                const diagramContainer = document.getElementById('flow-diagram');
                const detailTitle = document.getElementById('flow-detail-title');
                const detailContent = document.getElementById('flow-detail-content');

                flowData.forEach((step, index) => {
                    const stepEl = document.createElement('div');
                    stepEl.className = 'flow-step border-2 border-gray-300 rounded-lg p-4 text-center';
                    stepEl.innerHTML = `<div class="font-bold text-lg">${step.title}</div>`;
                    stepEl.dataset.index = index;
                    diagramContainer.appendChild(stepEl);

                    if (index < flowData.length -1) {
                        const arrowEl = document.createElement('div');
                        arrowEl.className = 'flow-arrow text-3xl text-center flex items-center justify-center';
                        arrowEl.innerHTML = `<span>â†“</span>`;
                        diagramContainer.appendChild(arrowEl);
                    }
                });
                
                diagramContainer.addEventListener('click', e => {
                    const stepEl = e.target.closest('.flow-step');
                    if (!stepEl) return;
                    
                    document.querySelectorAll('.flow-step').forEach(el => el.classList.remove('active'));
                    stepEl.classList.add('active');
                    
                    const index = parseInt(stepEl.dataset.index);
                    const stepData = flowData[index];
                    
                    detailTitle.textContent = stepData.title;
                    detailContent.textContent = stepData.content;
                });

                document.querySelector('.flow-step').click();
            }
            
            function setupCodeTabs() {
                const tabsNav = document.querySelector('#code-tabs-container nav');
                const contentContainer = document.getElementById('code-content-container');
                const files = Object.keys(codeData);

                files.forEach((file, index) => {
                    const button = document.createElement('button');
                    button.textContent = file;
                    button.className = 'tab-btn whitespace-nowrap py-2 px-4 border-b-2 font-medium text-sm rounded-t-lg';
                    button.dataset.target = file;
                    tabsNav.appendChild(button);

                    const contentDiv = document.createElement('div');
                    contentDiv.id = file;
                    contentDiv.className = 'code-content';
                    contentDiv.innerHTML = `<div class="code-block"><pre><code>${codeData[file].replace(/</g, "&lt;").replace(/>/g, "&gt;")}</code></pre></div>`;
                    if(index > 0) contentDiv.style.display = 'none';

                    contentContainer.appendChild(contentDiv);
                });

                tabsNav.addEventListener('click', (e) => {
                    if (e.target.tagName !== 'BUTTON') return;
                    
                    const targetFile = e.target.dataset.target;
                    
                    tabsNav.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    
                    contentContainer.querySelectorAll('.code-content').forEach(content => {
                        content.style.display = content.id === targetFile ? 'block' : 'none';
                    });
                });
                
                tabsNav.querySelector('button').classList.add('active');
            }

            function setupEnvTable() {
                const tableBody = document.getElementById('env-vars-table');
                envVars.forEach(v => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="py-3 px-4 whitespace-nowrap"><code class="font-mono text-sm bg-gray-100 p-1 rounded">${v.name}</code></td>
                        <td class="py-3 px-4 text-sm text-gray-600">${v.desc}</td>
                        <td class="py-3 px-4 text-center">
                            <button class="copy-btn p-2 rounded-md bg-gray-100 text-gray-600" title="å¤åˆ¶å˜é‡å">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                  <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                  <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zM9 1.5H7v1h2v-1z"/>
                                  <path d="M2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2zm8.5 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0v-8a.5.5 0 0 1 .5-.5z"/>
                                </svg>
                            </button>
                        </td>
                    `;
                    row.querySelector('.copy-btn').addEventListener('click', (e) => {
                        navigator.clipboard.writeText(v.name).then(() => {
                            const btn = e.currentTarget;
                            const originalTitle = btn.title;
                            btn.title = 'å·²å¤åˆ¶!';
                            setTimeout(() => { btn.title = originalTitle; }, 2000);
                        });
                    });
                    tableBody.appendChild(row);
                });
            }

            setupNavigation();
            setupFlowDiagram();
            setupCodeTabs();
            setupEnvTable();
        });
    </script>
</body>
</html>

